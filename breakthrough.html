<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BREAKTHROUGH — Stocks + Trends + Potential Tracker</title>
  <style>
    :root {
      --bg:#0b0f14; --panel:#111826; --border:#1c2633; --text:#e6eef7; --muted:#9fb3c8;
      --good:#19c37d; --bad:#d66; --warn:#d6a019; --accent:#8fb6ff; --chip:#0e1522;
    }
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

    .tabs{display:flex;gap:8px;align-items:center;padding:10px 16px;border-bottom:1px solid var(--border);background:#0a1018;position:sticky;top:0;z-index:5}
    .tab{padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:#0f1826;color:var(--muted);text-decoration:none;cursor:pointer}
    .tab.active{background:#172335;color:#fff;border-color:#223146}
    .tab.disabled{opacity:.55;cursor:not-allowed}

    header{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between}
    h1{margin:0;font-size:18px}
    .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .toolbar input{background:#0e1522;border:1px solid var(--border);border-radius:10px;padding:8px 10px;color:var(--text)}
    .toolbar button{background:#152235;border:1px solid var(--border);color:#e6eef7;padding:8px 12px;border-radius:10px;cursor:pointer}
    .toolbar button:hover{filter:brightness(1.1)}
    #last-updated{color:var(--muted);font-size:12px}

    .container{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;padding:16px;align-items:start}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:12px;position:relative}
    .card h2{margin:0 0 8px;font-size:13px;color:var(--muted);font-weight:600;letter-spacing:.2px;padding-right:36px}
    .remove-btn{position:absolute;top:10px;right:10px;background:#1b293d;border:1px solid var(--border);color:#d77;padding:4px 8px;border-radius:8px;font-size:12px;cursor:pointer}
    .remove-btn:hover{filter:brightness(1.1)}

    table{width:100%;border-collapse:collapse;color:var(--text)}
    th,td{border-color:var(--border);padding:6px 4px}
    th{border-bottom:1px solid var(--border);text-align:left}
    td.val{text-align:right}
    td.sig{text-align:center;width:60px}
    .ok{color:var(--good);font-weight:600}
    .ko{color:var(--muted)}
    .warn{color:var(--warn)}

    .spark{height:44px}
    .spark svg{width:100%;height:44px;display:block}
    .spark .line{fill:none;stroke:var(--accent);stroke-width:2}
    .spark .fill{fill:rgba(143,182,255,0.12);stroke:none}
    .spark .axis{stroke:#233046;stroke-width:1}

    @media (max-width:980px){
      .container{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <!-- Tabs -->
<nav class="tabs">
  <span class="tab active">INDEX</span>
  <a class="tab" href="./breakthrough.html">BREAKTHROUGH</a>
  <span class="tab disabled">SETTINGS</span>
</nav>


  <header>
    <h1>Stocks (left) • Google Trends (middle) • Potential Breakthrough (right)</h1>
    <div class="toolbar">
      <input id="in-symbol" placeholder="EXCHANGE:TICKER" size="26" />
      <input id="in-name" placeholder="Display name" size="18" />
      <input id="in-trend" placeholder="Google Trends term" size="18" />
      <button id="btn-add">Add / Update</button>
      <button id="btn-reset">Reset defaults</button>
      <button id="btn-refresh">Refresh</button>
      <span id="last-updated"></span>
    </div>
  </header>

  <div id="grid" class="container"></div>

  <script src="https://ssl.gstatic.com/trends_nrtr/3343_RC01/embed_loader.js"></script>
  <script>
    const DEFAULT_WATCHLIST = [
      { symbol: "NASDAQ:MVIS", name: "MicroVision", trendTerm: "MicroVision" },
      { symbol: "NASDAQ:QSI", name: "Quantum-Si", trendTerm: "Quantum-Si" }
    ];
    const STORAGE_KEY = 'WATCHLIST_BREAKTHROUGH';

    function yTicker(sym){ return String(sym||'').split(':').pop().toUpperCase(); }
    function rowIdFromSymbol(symbol){ return 'row-'+yTicker(symbol); }
    function cellId(rowId,key){ return `${key}-${rowId}`; }

    const grid = document.getElementById('grid');
    function getWatchlist(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY))||DEFAULT_WATCHLIST; }catch{ return DEFAULT_WATCHLIST; } }
    function setWatchlist(arr){ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }

    function renderTradingView(container, symbol){
      const wrap=document.createElement('div');
      wrap.innerHTML=`<div class="tradingview-widget-container__widget"></div>`;
      const s=document.createElement('script');
      s.src='https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js';
      s.innerHTML=JSON.stringify({symbols:[[symbol+"|1D"]],width:"100%",height:"100%",locale:"en"});
      wrap.appendChild(s);
      container.appendChild(wrap);
    }

    function renderTrends(container, keyword){
      const src = `https://trends.google.com/trends/embed/?q=${encodeURIComponent(keyword)}&geo=&date=today 1-m`;
      container.innerHTML=`<iframe src="${src}" width="100%" height="100%" frameborder="0"></iframe>`;
    }

    function buildRow(item){
      const rid=rowIdFromSymbol(item.symbol);

      const left=document.createElement('div');
      left.className='card';
      left.innerHTML=`<h2>${item.name} — Price & Chart</h2><div class="chart"></div>`;

      const mid=document.createElement('div');
      mid.className='card';
      mid.innerHTML=`<h2>Google Trends — “${item.trendTerm}”</h2><div class="trend" id="trend-${rid}"></div>`;

      const right=document.createElement('div');
      right.className='card';
      right.innerHTML=`
        <h2>Potential Breakthrough</h2>
        <table>
          <thead><tr><th>Metric</th><th class="val">Value</th><th class="sig">Signal</th></tr></thead>
          <tbody>
            <tr><td>Market Cap</td><td id="${cellId(rid,'cap')}" class="val">—</td><td id="${cellId(rid,'cap-s')}" class="sig">—</td></tr>
            <tr><td>P/E Ratio</td><td id="${cellId(rid,'pe')}" class="val">—</td><td id="${cellId(rid,'pe-s')}" class="sig">—</td></tr>
            <tr><td>Revenue Growth</td><td id="${cellId(rid,'rev')}" class="val">—</td><td id="${cellId(rid,'rev-s')}" class="sig">—</td></tr>
            <tr><td>Analyst Rating</td><td id="${cellId(rid,'rating')}" class="val">—</td><td id="${cellId(rid,'rating-s')}" class="sig">—</td></tr>
          </tbody>
        </table>`;

      grid.appendChild(left); grid.appendChild(mid); grid.appendChild(right);

      renderTradingView(left.querySelector('.chart'), item.symbol);
      renderTrends(mid.querySelector('.trend'), item.trendTerm);
    }

    function renderAll(){
      grid.innerHTML='';
      const list=getWatchlist();
      list.forEach(it=>buildRow(it));
      document.getElementById('last-updated').textContent="Last updated: "+new Date().toLocaleTimeString();
    }

    function addStock(){
      const s=document.getElementById('in-symbol').value.trim();
      const n=document.getElementById('in-name').value.trim()||s;
      const t=document.getElementById('in-trend').value.trim()||n;
      if(!s) return alert("Enter symbol in EXCHANGE:TICKER format");
      const list=getWatchlist();
      const idx=list.findIndex(x=>yTicker(x.symbol)===yTicker(s));
      if(idx===-1) list.push({symbol:s,name:n,trendTerm:t});
      else list[idx]={symbol:s,name:n,trendTerm:t};
      setWatchlist(list); renderAll();
    }

    document.getElementById('btn-add').addEventListener('click',addStock);
    document.getElementById('btn-reset').addEventListener('click',()=>{setWatchlist(DEFAULT_WATCHLIST);renderAll();});
    document.getElementById('btn-refresh').addEventListener('click',renderAll);

    renderAll();
  </script>
</body>
</html>
